---
title: "Chick Weight Data Summary"
author: "Saghir Bashir"
date: "14th June 2019"
output: ioslides_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
options(knitr.table.format = "html")

# Read in Libraries
library(magrittr)
library(knitr)
library(kableExtra)
library(ggplot2)
library(data.table)

# Prepare data for presentation
cw <- fread("ChickWeight.csv")
setnames(cw, c("weight"), c("Weight"))
cw[, Group := factor(paste0("Diet ", Diet))][
   , Time := factor(Time)][
   , Diet:=NULL]
setcolorder(cw, c("Group", "Chick", "Time", "Weight"))

cws <- cw[ ,
          .(N      = .N, 
            Mean   = mean(Weight),
            SDev   = sd(Weight),
            Median = median(Weight),
            Min    = min(Weight),
            Max    = max(Weight)  ),
          by=.(Group, Time)]
```

## Chick Weight Data

> *"The body weights of the chicks were measured at birth and every second day thereafter 
until day 20. They were also measured on day 21. There were four groups of chicks on 
different protein diets."*

## The Data

There are `r nrow(ChickWeight)` observations (rows) and `r ncol(ChickWeight)` variables:

- `Chick` -- unique ID for each chick. 
- `Diet` -- one of four protein diets. 
- `Time` --  number of days since birth. 
- `weight` -- body weight of chick in grams.

## Objective

Investigate the *effect of diet on the weight over time*.

## Summary Plot

```{r meanlinePlot, echo=FALSE}
ggplot(cw, aes(Time, Weight, group=Group, colour=Group)) +
  facet_wrap(~Group) +
  geom_jitter() +
  stat_summary(fun.y="mean", geom="line", colour="black") +
  theme(legend.position = "none") +
  ggtitle("Chick Weight over Time by Diet") + 
  xlab("Time (days)") +
  ylab("Weight (grams)")
```

## Summary Statistics

```{r dtSum, echo=FALSE}
cws[Time %in% c(0, 21)] %>% 
  kable(align="ccrrrrrr", digits = c(0, 0, 0, 1, 1, 2, 0, 0)) %>% 
  kable_styling(bootstrap_options = "striped", font_size = 24, full_width = TRUE) %>% 
  column_spec(1:8, width = "4em") %>% 
  collapse_rows(1, valign = "top")
```

## Conclusions

- Diet 3 has the highest mean.
- Diet 4 has the least variability
- Interpret with caution.
